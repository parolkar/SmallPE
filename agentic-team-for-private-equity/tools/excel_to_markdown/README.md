# Excel to Markdown Converter

A Ruby command-line tool that converts Microsoft Excel (.xlsx) files to Markdown format with proper table formatting. The tool processes all sheets in the Excel file and creates a single Markdown output file with all data organized sheet by sheet.

## Features

- **Complete Excel Support**: Handles .xlsx and .xls files
- **Multi-sheet Processing**: Converts all sheets into a single Markdown file
- **Intelligent Formatting**:
  - Preserves data types (dates, numbers, text)
  - Creates properly formatted Markdown tables
  - Handles empty cells and sheets gracefully
- **Colored Terminal Output**: Visual feedback during conversion
- **Sheet Information**: Display detailed information about Excel files before conversion
- **Flexible Options**: Choose specific sheets or process all sheets

## Installation

1. Clone or download this repository:
```bash
git clone <repository-url>
cd excel_to_markdown
```

2. Install dependencies:
```bash
bundle install
```

Or install gems manually:
```bash
gem install roo thor colorize
```

## Usage

### Basic Conversion

Convert an Excel file to Markdown:
```bash
./excel2md convert input.xlsx
```

This creates `input.md` in the same directory.

### Specify Output File

```bash
./excel2md convert input.xlsx -o output.md
```

### Convert Specific Sheet

```bash
./excel2md convert input.xlsx --sheet "Sheet1"
```

### Verbose Mode

Get detailed processing information:
```bash
./excel2md convert input.xlsx -v
```

### View File Information

Inspect Excel file structure before conversion:
```bash
./excel2md info input.xlsx
```

### Command Options

```
Commands:
  excel2md convert FILE [OPTIONS]  # Convert Excel file to Markdown
  excel2md info FILE               # Display information about Excel file
  excel2md version                 # Display version information

Options:
  -o, --output     Output file path (default: input_file.md)
  -v, --verbose    Verbose output
  -s, --sheet      Specific sheet name to convert (default: all sheets)
```

## Output Format

The tool generates a Markdown file with the following structure:

1. **Header**: File metadata and conversion timestamp
2. **Sheet Sections**: Each sheet as a separate section with:
   - Sheet name as heading
   - Data formatted as Markdown tables
   - Empty sheet notifications
3. **Footer**: Generation signature

### Example Output

```markdown
# Excel to Markdown Conversion

**Source File:** `sales_data.xlsx`
**Converted:** 2024-01-15 10:30:45

---

## Sheet: Q1 Sales

| Product     | January | February | March  |
| ----------- | ------- | -------- | ------ |
| Widget A    | 1500    | 1750     | 2000   |
| Widget B    | 2300    | 2100     | 2450   |
| Widget C    | 890     | 950      | 1100   |

---

## Sheet: Q2 Sales

| Product     | April   | May      | June   |
| ----------- | ------- | -------- | ------ |
| Widget A    | 2200    | 2400     | 2300   |
| Widget B    | 2500    | 2600     | 2700   |
| Widget C    | 1200    | 1350     | 1400   |

---

*Generated by excel2md*
```

## Data Type Handling

The tool intelligently handles different data types:

- **Numbers**: Formatted with appropriate precision (integers shown without decimals)
- **Dates**: Converted to `YYYY-MM-DD HH:MM:SS` format
- **Text**: Preserved with special characters escaped for Markdown
- **Empty Cells**: Shown as blank in the table
- **Formulas**: Results are extracted (not the formula itself)

## Error Handling

The tool provides clear error messages for common issues:

- File not found
- Invalid file format
- Corrupted Excel files
- Missing permissions
- Sheet not found (when using --sheet option)

## System Requirements

- Ruby 2.5 or higher
- Bundler (optional, for dependency management)

## Troubleshooting

### Permission Denied

Make the script executable:
```bash
chmod +x excel2md
```

### Missing Dependencies

Install required gems:
```bash
bundle install
```

### Large Files

For very large Excel files, the conversion might take some time. Use verbose mode (`-v`) to monitor progress.

## License

MIT License

## Contributing

Contributions are welcome! Please feel free to submit issues and pull requests.